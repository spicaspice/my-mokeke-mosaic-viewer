Mokeke コレクション管理（現行版）
===============================

このフォルダの `index.html` で、`mokekelist.txt`（または同等のTSV/セクション形式）を読み込み、検索・カテゴリ絞り込み・取得チェック（進捗保存）・画像表示まで行える静的Webアプリです。

使い方（推奨の起動方法）
-----------------------

1) 簡易サーバで起動
- PowerShell/Terminal で本フォルダへ移動
- Python があれば: `python -m http.server 8000`
- ブラウザで `http://localhost:8000/` を開く

2) リストの読み込み（3つの方法）
- 右上「リスト読込」から `mokekelist.txt` を選択
- 画面内の枠へドラッグ＆ドロップ
- 「貼り付け読み込み」欄にリスト内容を貼り付け → 読み込み

共有（家族に一覧を共有）
----------------------

- 右上「共有リンク」ボタンで、現在の進捗付きURLをクリップボードにコピーします。
- 相手はそのURLで本アプリにアクセスすると、同じリストを読み込み、進捗（取得チェック）が反映されます。
- 注意: 共有リンクは「リストファイル名（例: `mokekelist_20250906.txt`）が同じ場所にある」前提です。リスト自体を配る場合はリポジトリ/ZIPごと渡してください。

GitHub Pages で公開（推奨）
-----------------------

1) GitHub にこのフォルダの内容をプッシュ（`main` か `master` ブランチ）
2) リポジトリに Actions が有効であることを確認
3) すでに同梱のワークフローが自動実行され、`github-pages` 環境にデプロイされます
   - 設定ファイル: `.github/workflows/github-pages.yml`
   - ルートにある以下を公開します: `index.html`, `styles.css`, `app.js`, `image_loader.js`, `mokekelist*.txt`, `image_data.csv`, `images/`
4) 完了後、Actions のログに公開URL（`page_url`）が表示されます

補足
- 大きいバックアップZIP等は公開対象に含めていません（ワークフローで `_site/` に必要ファイルのみコピー）
- `file://` 直開きでの制限も GitHub Pages では発生しません
- `favicon.ico` が無い404を避けるため、データURIの空ファビコンを `index.html` に追加済み

3) 操作
- 検索欄、取得状況フィルタ、カテゴリ（大分類>小分類）から絞り込み
- 各アイテム左のチェックで進捗を保存（自動）
- 右上から「エクスポート/インポート」で進捗のバックアップ/共有
- サムネイル/画像ボタンから画像ビューアを開く

リストのフォーマット
------------------

どちらかの形式に対応します。

- セクション形式（簡易INI）
  - `#` 始まりはコメント、空行は無視
  - `[カテゴリ名]` 行でカテゴリ開始
  - それ以外はアイテム名（一番近いカテゴリ配下。未指定は「未分類」）

- TSV（タブ区切り）形式（推奨）
  - 想定列例: 大分類, 小分類, 地域, 番号, 名称, カラー, 取得日 など
  - 列構成は柔軟で、主要情報（地域/名称/カラー/日付など）を自動推定して表示名や進捗に反映します

進捗の保存
----------

- 読み込んだリストの内容からハッシュを作り、`localStorage` に `mokeke:v1:<ハッシュ>` で保存
- 同一内容のリストなら進捗が共有。内容を変えた場合は新しい進捗領域になります
- 右上からエクスポート/インポート可能

画像表示について
--------------

- `images/` 以下に地域別フォルダ（例: `01hokkaido`, `02tohoku`, …）と画像を配置
- `image_data.csv` を読み込んで、画像メタ（地域/番号/名前/カラー/パス）と紐付けます
- 初回は次の手順で CSV を生成できます:
  1. Node.js 環境で `node extract_image_data.js`
  2. `images/<region>/` 配下の `*.jpg` を解析し、`image_data.csv` を出力
- 読み込み後は各アイテムに可能な限りサムネイルを自動付与。クリックでフルスクリーンビューアを表示

トラブルシュート
--------------

- ファイル直開き（`file://`）だとブラウザの制限で一部機能（`fetch`/ファイル選択）が動かない場合があります。`http://localhost:8000` での起動を推奨
- 文字化けする場合は、TSV/テキストのエンコードを UTF-8 に。アプリ側は UTF-8/Shift_JIS/UTF-16LE/BE の自動判定を試行します
- サムネイルが出ない場合は、`image_data.csv` が最新か、`images/<region>/` 配下のファイル名パターンが想定通りか確認してください

主要ファイル
----------

- `index.html` …… UI 本体（ヘッダ/カテゴリ/リスト/ビューア/デバッグ）
- `styles.css` …… ダークテーマのスタイル（画像ボタン/モーダル等）
- `app.js` ……… リスト読込・自動エンコード判定・TSV/セクション自動解析・描画・進捗保存・画像紐付け
- `image_loader.js` …… `image_data.csv` を読み込み、`window.mokekeImageData` として公開
- `extract_image_data.js` …… `images/` から `image_data.csv` を生成するユーティリティ（Node）
- `mokekelist*.txt` …… リストサンプル

推奨ブラウザ
----------

- 最新の Chrome / Edge / Firefox

ライセンス
--------

- プロジェクト内の画像など第三者コンテンツの扱いにご注意ください。本アプリ自体はリスト管理・閲覧用途です。
